<nav class="bg-white fixed w-full z-30 top-0 left-0 border-b border-gray-200">
    <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
        <a routerLink="/" class="flex items-center">
            <span class="self-center text-2xl font-bold whitespace-nowrap text-abtech-blue">AbTech</span>
        </a>
        <div class="flex md:order-2 items-center">
            <!-- Language Switcher -->
            <!-- Selectors Container -->
            <div class="flex items-center space-x-4">

                <!-- Custom Theme Selector -->
                <div class="relative" (mouseleave)="delayedCloseDropdown()" (mouseenter)="cancelCloseDropdown()">
                    <button (click)="toggleDropdown('theme')"
                        class="flex items-center gap-2 px-3 py-1.5 bg-gray-50 border border-gray-300 rounded-lg text-xs font-medium text-gray-700 hover:bg-gray-100 dark:bg-slate-800 dark:border-slate-600 dark:text-gray-200 dark:hover:bg-slate-700 transition-colors">
                        <span class="flex items-center gap-2">
                            <i *ngIf="currentTheme === 'light'" class="fas fa-sun text-yellow-500"></i>
                            <i *ngIf="currentTheme === 'dark'" class="fas fa-moon text-blue-400"></i>
                            <i *ngIf="currentTheme === 'auto'" class="fas fa-cog text-gray-500 dark:text-gray-400"></i>
                            <span class="uppercase">{{ currentTheme }}</span>
                        </span>
                        <i class="fas fa-chevron-down text-[10px] ml-1 opacity-70"></i>
                    </button>

                    <!-- Dropdown Panel -->
                    <div *ngIf="activeDropdown === 'theme'" (mouseenter)="cancelCloseDropdown()"
                        class="absolute right-0 mt-2 w-32 bg-white dark:bg-slate-800 border border-gray-100 dark:border-slate-700 rounded-lg shadow-xl z-50 py-1 animate-in fade-in slide-in-from-top-2 duration-200">
                        <button (click)="setTheme('light'); toggleDropdown('theme')"
                            class="w-full text-left px-4 py-2 text-xs flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-slate-700 dark:text-gray-200">
                            <i class="fas fa-sun text-yellow-500 w-4"></i> Light
                        </button>
                        <button (click)="setTheme('dark'); toggleDropdown('theme')"
                            class="w-full text-left px-4 py-2 text-xs flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-slate-700 dark:text-gray-200">
                            <i class="fas fa-moon text-blue-400 w-4"></i> Dark
                        </button>
                        <button (click)="setTheme('auto'); toggleDropdown('theme')"
                            class="w-full text-left px-4 py-2 text-xs flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-slate-700 dark:text-gray-200">
                            <i class="fas fa-cog text-gray-500 w-4"></i> Auto
                        </button>
                    </div>
                </div>

                <!-- Custom Language Selector: Reverted to Buttons style -->
                <!-- Dropped 'relative' container hover logic since buttons are direct actions, 
                     but if we want to restore dropdown logic for lang, we need the dropdown structure back.
                     Wait, the user previous step reverted to buttons. 
                     Checking recent context: Just 2 steps ago 'reverted to buttons'.
                     BUT the user complaint implies interaction difficulty with a 'combobox' closing fast.
                     This means the user likely accepted the 'Combobox with local flags' restoration in step 1073/1082 BEFORE the revert in 1033??
                     Ah, Step 1033 reverted to buttons. Step 1044 requested 'combobox like before but with local images'.
                     Step 1073 RESTORED the dropdown.
                     So we ARE using dropdowns now.
                     My previous view_file (implicit context) suggests we are using dropdown structure.
                     Let me verify the target content match.
                  -->
                <div class="relative" (mouseleave)="delayedCloseDropdown()" (mouseenter)="cancelCloseDropdown()">
                    <button (click)="toggleDropdown('lang')"
                        class="flex items-center gap-2 px-3 py-1.5 bg-gray-50 border border-gray-300 rounded-lg text-xs font-medium text-gray-700 hover:bg-gray-100 dark:bg-slate-800 dark:border-slate-600 dark:text-gray-200 dark:hover:bg-slate-700 transition-colors">
                        <img [src]="getFlagUrl(currentLang)" alt="Flag"
                            class="w-5 h-3.5 object-cover rounded shadow-sm">
                        <span class="uppercase">{{ currentLang }}</span>
                        <i class="fas fa-chevron-down text-[10px] ml-1 opacity-70"></i>
                    </button>

                    <!-- Dropdown Panel -->
                    <div *ngIf="activeDropdown === 'lang'" (mouseenter)="cancelCloseDropdown()"
                        class="absolute right-0 mt-2 w-32 bg-white dark:bg-slate-800 border border-gray-100 dark:border-slate-700 rounded-lg shadow-xl z-50 py-1 animate-in fade-in slide-in-from-top-2 duration-200">
                        <button (click)="switchLanguage('es')"
                            class="w-full text-left px-4 py-2 text-xs flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-slate-700 dark:text-gray-200">
                            <img src="/assets/images/flags/mx.png" class="w-5 h-3.5 object-cover rounded shadow-sm">
                            Spanish
                        </button>
                        <button (click)="switchLanguage('en')"
                            class="w-full text-left px-4 py-2 text-xs flex items-center gap-3 hover:bg-gray-50 dark:hover:bg-slate-700 dark:text-gray-200">
                            <img src="/assets/images/flags/gb.png" class="w-5 h-3.5 object-cover rounded shadow-sm">
                            English
                        </button>
                    </div>
                </div>
            </div>

            <a routerLink="/login"
                class="text-white bg-abtech-blue hover:bg-abtech-darkblue focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-4 py-2 text-center mr-3 md:mr-0 transition-colors duration-300">
                {{ 'HEADER.LOGIN' | translate }}
            </a>
            <button (click)="toggleMenu()" type="button"
                class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200"
                aria-controls="navbar-sticky" [attr.aria-expanded]="isMenuOpen">
                <span class="sr-only">Open main menu</span>
                <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                    viewBox="0 0 17 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M1 1h15M1 7h15M1 13h15" />
                </svg>
            </button>
        </div>

        <div class="items-center justify-between w-full md:flex md:w-auto md:order-1" [class.hidden]="!isMenuOpen"
            id="navbar-sticky">
            <ul
                class="flex flex-col p-4 md:p-0 mt-4 font-medium border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 md:mt-0 md:border-0 md:bg-white">

                <!-- Soluciones Dropdown -->
                <li class="relative group">
                    <button (click)="toggleDropdown('soluciones')" (mouseenter)="openDropdown('soluciones')"
                        class="flex items-center justify-between w-full py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-abtech-blue md:p-0 md:w-auto">
                        {{ 'HEADER.SOLUTIONS' | translate }} <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true"
                            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m1 1 4 4 4-4" />
                        </svg>
                    </button>
                    <!-- Dropdown menu -->
                    <div [class.hidden]="activeDropdown !== 'soluciones'" (mouseleave)="closeDropdown()"
                        class="absolute z-10 font-normal bg-white divide-y divide-gray-100 rounded-lg shadow w-72 mt-2 md:mt-4">
                        <ul class="py-2 text-sm text-gray-700 dark:text-gray-400" aria-labelledby="dropdownLargeButton">
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Transformación Digital</strong><span
                                        class="text-xs text-gray-500 block">Transforma procesos con tecnología
                                        moderna</span></a></li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Experiencia del Cliente</strong><span
                                        class="text-xs text-gray-500 block">Soluciones digitales intuitivas</span></a>
                            </li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Digitalización de Procesos</strong><span
                                        class="text-xs text-gray-500 block">Automatización inteligente</span></a></li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Modernización Legacy</strong><span
                                        class="text-xs text-gray-500 block">Migración y mejora de sistemas</span></a>
                            </li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Desarrollo Personalizado</strong><span
                                        class="text-xs text-gray-500 block">Software a la medida</span></a></li>
                        </ul>
                    </div>
                </li>

                <!-- Desarrollo Dropdown -->
                <li class="relative group">
                    <button (click)="toggleDropdown('desarrollo')" (mouseenter)="openDropdown('desarrollo')"
                        class="flex items-center justify-between w-full py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-abtech-blue md:p-0 md:w-auto">
                        {{ 'HEADER.DEVELOPMENT' | translate }} <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true"
                            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m1 1 4 4 4-4" />
                        </svg>
                    </button>
                    <div [class.hidden]="activeDropdown !== 'desarrollo'" (mouseleave)="closeDropdown()"
                        class="absolute z-10 font-normal bg-white divide-y divide-gray-100 rounded-lg shadow w-64 mt-2 md:mt-4">
                        <ul class="py-2 text-sm text-gray-700">
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Desarrollo Web</strong><span
                                        class="text-xs text-gray-500 block">Apps escalables y seguras</span></a></li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Desarrollo Móvil</strong><span
                                        class="text-xs text-gray-500 block">Multiplataforma (iOS/Android)</span></a>
                            </li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Nearshore Staffing</strong><span
                                        class="text-xs text-gray-500 block">Talento especializado remoto</span></a></li>
                        </ul>
                    </div>
                </li>

                <!-- Industrias Dropdown -->
                <li class="relative group">
                    <button (click)="toggleDropdown('industrias')" (mouseenter)="openDropdown('industrias')"
                        class="flex items-center justify-between w-full py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-abtech-blue md:p-0 md:w-auto">
                        {{ 'HEADER.INDUSTRIES' | translate }} <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true"
                            xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="m1 1 4 4 4-4" />
                        </svg>
                    </button>
                    <div [class.hidden]="activeDropdown !== 'industrias'" (mouseleave)="closeDropdown()"
                        class="absolute z-10 font-normal bg-white divide-y divide-gray-100 rounded-lg shadow w-64 mt-2 md:mt-4">
                        <ul class="py-2 text-sm text-gray-700">
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Salud</strong><span
                                        class="text-xs text-gray-500 block">Gestión clínica y médica</span></a></li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Deportes</strong><span
                                        class="text-xs text-gray-500 block">Ligas, torneos y equipos</span></a></li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Bienes Raíces</strong><span
                                        class="text-xs text-gray-500 block">Administración de propiedades</span></a>
                            </li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Recursos Humanos</strong><span
                                        class="text-xs text-gray-500 block">Procesos internos y empleados</span></a>
                            </li>
                            <li><a routerLink="/" class="block px-4 py-2 hover:bg-gray-100"><strong
                                        class="block text-gray-900">Educación</strong><span
                                        class="text-xs text-gray-500 block">Plataformas educativas</span></a></li>
                        </ul>
                    </div>
                </li>

                <li>
                    <a routerLink="/" fragment="contact"
                        class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-abtech-blue md:p-0 transition-colors">{{
                        'HEADER.CONTACT' | translate }}</a>
                </li>
            </ul>
        </div>
    </div>
</nav>